% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_titeboin.R
\name{sim_titeboin}
\alias{sim_titeboin}
\title{Simulate TITE-BOIN Trials}
\usage{
sim_titeboin(
  n_trials,
  decision_table,
  stopping_boundaries,
  target,
  p_true,
  n_doses,
  ncohort,
  cohort_size,
  maxt,
  accrual_rate,
  alpha1 = 0.5,
  alpha2 = 0.5,
  tite_distribution = "weibull",
  neli = 3,
  cutoff_eli = 0.95,
  n_earlystop = 100,
  min_sample = 1,
  seed = NULL
)
}
\arguments{
\item{n_trials}{Number of simulation trials}

\item{decision_table}{Decision table in simulation format from
\code{convert_titeboin_decision_to_sim_format()}}

\item{stopping_boundaries}{Early stopping rule table from
\code{get_boin_stopping_boundaries()}}

\item{target}{Target toxicity rate (e.g., 0.30 for 30\\%)}

\item{p_true}{Vector of true toxicity probabilities for each dose level}

\item{n_doses}{Number of dose levels}

\item{ncohort}{Maximum number of cohorts to enroll}

\item{cohort_size}{Number of patients per cohort (typically 3)}

\item{maxt}{Maximum observation period for toxicity assessment (in time units)}

\item{accrual_rate}{Patient accrual rate (patients per time unit)}

\item{alpha1}{Late-onset toxicity parameter (default: 0.5). This parameter
controls the proportion of toxicities occurring in the first half of the
observation period}

\item{alpha2}{Shape parameter for the time-to-event distribution (default: 0.5).
Controls the hazard pattern over time}

\item{tite_distribution}{Distribution for time-to-toxicity. Options:
\itemize{
\item "weibull": Weibull distribution (default)
\item "log-logistic": Log-logistic distribution
}}

\item{neli}{Minimum sample size required for dose elimination (default: 3)}

\item{cutoff_eli}{Posterior probability cutoff for dose elimination (default: 0.95)}

\item{n_earlystop}{Maximum sample size at a dose before forcing advancement
(default: 100, effectively no limit)}

\item{min_sample}{Minimum sample size at a dose for MTD selection (default: 1)}

\item{seed}{Random seed for reproducibility (optional)}
}
\value{
A list containing:
\describe{
\item{summary}{A list of summary statistics including:
\itemize{
\item \code{mtd_selection_percent}: Percentage of trials selecting each dose as MTD
\item \code{avg_n_pts}: Average number of patients treated at each dose
\item \code{avg_total_n_pts}: Average total number of patients per trial
\item \code{avg_n_tox}: Average number of toxicities at each dose
\item \code{avg_total_n_tox}: Average total toxicities per trial
\item \code{percent_no_mtd}: Percentage of trials with no MTD selected
\item \code{avg_duration}: Average trial duration
\item \code{sd_duration}: Standard deviation of trial duration
}
}
}
}
\description{
Conduct Monte Carlo simulations of Time-to-Event Bayesian Optimal Interval
(TITE-BOIN) dose-finding trials to evaluate operating characteristics.
The function simulates multiple trials under specified true toxicity scenarios
and summarizes MTD selection rates, patient allocation, and trial duration.
}
\details{
The TITE-BOIN design extends the standard BOIN design to handle late-onset
toxicities by making real-time dose decisions while some patients' toxicity
outcomes are still pending. This accelerates trial conduct compared to
traditional designs that wait for all patients to complete follow-up before
enrolling the next cohort.

The simulation assumes:
\itemize{
\item Continuous patient accrual at the specified rate
\item Toxicity assessment window of length \code{maxt}
\item Dose decisions made after each cohort enrollment
\item Isotonic regression for MTD selection at trial end
}
}
\examples{
\dontrun{
# Set up trial parameters
target <- 0.30
p_true <- c(0.25, 0.41, 0.45, 0.49, 0.53)
n_doses <- length(p_true)

# Generate BOIN boundaries
boundary <- get_boin_boundary(target)

# Generate TITE-BOIN decision table
dt_full <- get_titeboin_decision(
  lambda_e = boundary$lambda_e,
  lambda_d = boundary$lambda_d,
  target = target,
  n_max = 18,
  cohort_size = 3
)

# Convert to simulation format
decision_table <- convert_titeboin_decision_to_sim_format(dt_full)

# Generate stopping boundaries
stopping_boundaries <- get_boin_stopping_boundaries(
  target = target,
  max_sample_size = 18,
  cutoff_stop = 0.90
)

# Run simulation
result <- sim_titeboin(
  n_trials = 1000,
  decision_table = decision_table,
  stopping_boundaries = stopping_boundaries,
  target = target,
  p_true = p_true,
  n_doses = n_doses,
  ncohort = 10,
  cohort_size = 3,
  maxt = 3,
  accrual_rate = 1,
  alpha1 = 0.5,
  alpha2 = 0.5,
  tite_distribution = "weibull",
  neli = 3,
  cutoff_eli = 0.95,
  n_earlystop = 18,
  min_sample = 1,
  seed = 123
)

# Display results
print_simulation_summary_titeboin(result$summary, n_doses)
}

}
\references{
Yuan, Y., Lin, R., Li, D., Nie, L. and Warren, K.E. (2018).
Time-to-Event Bayesian Optimal Interval Design to Accelerate Phase I Trials.
Clinical Cancer Research, 24(20): 4921-4930.

Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I
Clinical Trials. Journal of the Royal Statistical Society: Series C, 64, 507-523.
}
\seealso{
\code{\link{get_titeboin_decision}} for generating decision tables,
\code{\link{convert_titeboin_decision_to_sim_format}} for format conversion,
\code{\link{print_simulation_summary_titeboin}} for displaying results
}
