% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_boin_multi.R
\name{sim_boin_multi}
\alias{sim_boin_multi}
\title{Run BOIN Simulation for Multiple Scenarios}
\usage{
sim_boin_multi(
  scenarios,
  target,
  n_trials = 10000,
  n_cohort,
  cohort_size,
  n_earlystop = 18,
  cutoff_eli = 0.95,
  extrasafe = FALSE,
  offset = 0.05,
  n_earlystop_rule = "with_stay",
  titration = FALSE,
  min_mtd_sample = 1,
  boundMTD = FALSE,
  return_details = FALSE,
  seed = 123
)
}
\arguments{
\item{scenarios}{List of scenario definitions. Each element must be a list containing:
\describe{
\item{\code{name}}{Character. Scenario identifier (e.g., "Scenario 1")}
\item{\code{p_true}}{Numeric vector. True toxicity probabilities for each dose}
}
Example: \code{list(name = "Scenario 1", p_true = c(0.05, 0.10, 0.15, 0.20))}}

\item{target}{Numeric. Target toxicity probability (e.g., 0.30 for 30\%).}

\item{n_trials}{Numeric. Number of trials to simulate per scenario. Default is 10000.
Larger values (e.g., 10000) yield more stable operating characteristics
at the cost of increased computation time.}

\item{n_cohort}{Numeric. Maximum number of cohorts per trial.}

\item{cohort_size}{Numeric vector or scalar. Patients per cohort. If scalar, all cohorts
use the same size. If vector, each element specifies size for corresponding cohort.}

\item{n_earlystop}{Numeric. Sample size triggering early stopping. Default is 18.}

\item{cutoff_eli}{Numeric. Cutoff probability for dose elimination. Default is 0.95.}

\item{extrasafe}{Logical. Apply extra safety stopping rule at lowest dose. Default is FALSE.}

\item{offset}{Numeric. Offset for safety cutoff when extrasafe = TRUE. Default is 0.05.}

\item{n_earlystop_rule}{Character. Early stopping rule: "with_stay" or "simple". Default is "with_stay".}

\item{titration}{Logical. Perform accelerated dose titration phase. Default is FALSE.}

\item{min_mtd_sample}{Numeric. Minimum patients required for MTD consideration. Default is 1.}

\item{boundMTD}{Logical. Impose constraint that MTD's isotonic estimate <= lambda_d. Default is FALSE.}

\item{return_details}{Logical. If TRUE, return detailed trial-level results for each scenario.
If FALSE (default), return summary statistics only for memory efficiency.}

\item{seed}{Numeric. Random seed for reproducibility. Default is 123.}
}
\value{
A list with class "boin_multi_results" containing:
\item{results_by_scenario}{List of length equal to number of scenarios.
Each element contains the output from \code{sim_boin()} for that scenario.}
\item{combined_summary_df}{Data frame with aggregated operating characteristics
across all scenarios. Rows are organized as:
True DLT Rate (\%), MTD Selected (\%), Number of Participants Treated,
and Number of Participants w/ DLTs.
Columns represent doses plus "N/S Total" for overall statistics.}
\item{scenario_names}{Character vector of scenario identifiers.}
\item{n_doses}{Numeric. Number of doses evaluated (inferred from first scenario).}
\item{call}{The function call as entered by the user.}
}
\description{
Execute BOIN trial simulations across multiple dose-toxicity scenarios and
compute operating characteristics for each scenario. Results are aggregated
into a combined summary table suitable for protocol development and reports.
}
\details{
This function orchestrates simulations across multiple scenarios by:
\enumerate{
\item Validating scenario specifications
\item Running \code{\link{sim_boin}} for each scenario independently
\item Aggregating results into a unified data frame
\item Organizing output for easy comparison across scenarios
}

Operating characteristics computed for each scenario include:
\itemize{
\item True DLT Rate: Actual dose-toxicity relationship
\item MTD Selected: Percentage selecting each dose as MTD (+ percent with no MTD)
\item Number of Participants Treated: Average enrollment per dose
\item Number of Participants w/ DLTs: Average DLT count per dose
}

Progress messages are printed to console for monitoring simulation status.
For large-scale studies (50+ scenarios), computation time may be substantial.
Use \code{return_details = FALSE} (default) for faster execution.
}
\examples{
\dontrun{
# Define multiple scenarios with different dose-toxicity relationships
scenarios <- list(
  list(name = "Scenario 1: Linear Increase",
       p_true = c(0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45)),
  list(name = "Scenario 2: Steep Early",
       p_true = c(0.01, 0.025, 0.05, 0.075, 0.10, 0.125, 0.15, 0.20, 0.30)),
  list(name = "Scenario 3: Plateau",
       p_true = c(0.15, 0.20, 0.25, 0.30, 0.45, 0.50, 0.50, 0.50, 0.50))
)

# Run simulations across all scenarios
result <- sim_boin_multi(
  scenarios = scenarios,
  target = 0.30,
  n_trials = 10000,
  n_cohort = 48,
  cohort_size = 3,
  seed = 123
)

# View aggregated results (plain text)
print(result)

# View as kable Markdown table
print(result, kable = TRUE, kable_format = "pipe")

# Access scenario-specific results
result$results_by_scenario[["Scenario 1: Linear Increase"]]
}

}
\references{
Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I Clinical
Trials. Journal of the Royal Statistical Society: Series C, 64, 507-523.
}
