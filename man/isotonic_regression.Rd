% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/isotonic_regression.R
\name{isotonic_regression}
\alias{isotonic_regression}
\title{Isotonic Regression for Toxicity Rate Estimation}
\usage{
isotonic_regression(n_pts, n_tox, min_sample = 6)
}
\arguments{
\item{n_pts}{Numeric vector. Number of patients treated at each dose level.}

\item{n_tox}{Numeric vector. Number of patients with dose-limiting toxicity (DLT) at each dose level.}

\item{min_sample}{Numeric. Minimum number of patients required for a dose to be considered
for estimation. Default is 6. Doses with fewer patients return NA.}
}
\value{
Numeric vector of isotonic-adjusted toxicity rate estimates for each dose.
Values are NA for doses with insufficient sample size (< min_sample).
}
\description{
Estimate toxicity rates at each dose level under the monotonicity constraint
(toxicity increases with dose) using the Pool Adjacent Violators Algorithm (PAVA).
Incorporates pseudocount (Beta-Binomial prior) to align with BOIN methodology.
Uses vectorized computation for efficiency.
}
\details{
PAVA enforces the constraint that estimated toxicity rates are monotonically
increasing across doses. Pseudocounts (0.05 to DLT count, 0.1 to total patients)
are added before estimation, reflecting a Beta-Binomial conjugate prior.
Patient counts are weighted by inverse variance in PAVA to account for
estimation uncertainty.

The MTD selection is based on these isotonic-adjusted estimates, ensuring
that the dose-toxicity relationship respects the natural monotonicity assumption.
}
\examples{
# Estimate isotonic toxicity rates after trial completion
n_pts <- c(3, 6, 9, 12)
n_tox <- c(0, 1, 3, 4)
iso_est <- isotonic_regression(n_pts, n_tox, min_sample = 3)
print(iso_est)

}
\references{
Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I Clinical
Trials. Journal of the Royal Statistical Society: Series C, 64, 507-523.
}
