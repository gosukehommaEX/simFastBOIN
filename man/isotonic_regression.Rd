% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/isotonic_regression.R, R/sim_boin.R
\name{isotonic_regression}
\alias{isotonic_regression}
\title{Isotonic Regression for Toxicity Rate Estimation}
\usage{
isotonic_regression(n_pts, n_tox, min_sample = 6)

isotonic_regression(n_pts, n_tox, min_sample = 6)
}
\arguments{
\item{n_pts}{Numeric vector. Number of patients treated at each dose.}

\item{n_tox}{Numeric vector. Number of patients with DLTs at each dose.}

\item{min_sample}{Numeric. Minimum sample size for dose inclusion. Default is 6.}
}
\value{
\itemize{
\item If n_pts is vector: Numeric vector of isotonic-adjusted toxicity rates
\item If n_pts is matrix: Matrix with same dimensions as input, isotonic estimates
for each row computed independently
}

Numeric vector of isotonic-adjusted toxicity rate estimates.
}
\description{
Estimate toxicity rates at each dose level under the monotonicity constraint
(toxicity increases with dose) using the Pool Adjacent Violators Algorithm (PAVA).
Incorporates pseudocount (Beta-Binomial prior) to align with BOIN methodology.
Supports both single dose set and multiple dose sets (matrix input).
No external package dependencies.

Estimate toxicity rates at each dose level under monotonicity constraint.
Uses PAVA (Pool Adjacent Violators Algorithm) without external packages.
Incorporates pseudocount (Beta-Binomial prior).
}
\details{
PAVA enforces the constraint that estimated toxicity rates are monotonically
increasing across doses. Pseudocounts (0.05 to DLT count, 0.1 to total patients)
are added before estimation, reflecting a Beta-Binomial conjugate prior.
Patient counts are weighted by inverse variance in PAVA to account for
estimation uncertainty.

The MTD selection is based on these isotonic-adjusted estimates, ensuring
that the dose-toxicity relationship respects the natural monotonicity assumption.

Pseudocounts are added: (y + 0.05) / (n + 0.1).
Patient counts weighted by inverse variance are used as weights in PAVA.
Doses with fewer than min_sample patients return NA.
}
\examples{
# Single dose set
n_pts <- c(3, 6, 9, 12)
n_tox <- c(0, 1, 3, 4)
iso_est <- isotonic_regression(n_pts, n_tox, min_sample = 3)
print(iso_est)

# Multiple dose sets (matrix)
n_pts_matrix <- matrix(c(3, 6, 9, 12, 3, 6, 9, 12), nrow = 2, byrow = TRUE)
n_tox_matrix <- matrix(c(0, 1, 3, 4, 1, 2, 4, 5), nrow = 2, byrow = TRUE)
iso_est_matrix <- isotonic_regression(n_pts_matrix, n_tox_matrix, min_sample = 3)
print(iso_est_matrix)

}
\references{
Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I Clinical
Trials. Journal of the Royal Statistical Society: Series C, 64, 507-523.
}
\keyword{internal}
