% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/isotonic_regression.R
\name{isotonic_regression}
\alias{isotonic_regression}
\title{Isotonic Regression for Toxicity Rate Estimation}
\usage{
isotonic_regression(n_pts, n_tox, min_sample = 6)
}
\arguments{
\item{n_pts}{Numeric vector (single dose set) or matrix (multiple dose sets).
Number of patients treated at each dose level.
\itemize{
\item Vector: length n_doses
\item Matrix: nrow = n_trials, ncol = n_doses
}}

\item{n_tox}{Numeric vector or matrix with same shape as n_pts.
Number of patients with dose-limiting toxicity (DLT) at each dose level.}

\item{min_sample}{Numeric. Minimum number of patients required for a dose to be considered.
Default is 6. Doses with fewer patients return NA.}
}
\value{
\itemize{
\item If n_pts is vector: Numeric vector of isotonic-adjusted toxicity rates
\item If n_pts is matrix: Matrix with same dimensions, isotonic estimates by row
}
}
\description{
Estimate toxicity rates at each dose level under the monotonicity constraint
using the Pool Adjacent Violators Algorithm (PAVA) without external packages.
Supports both single dose set (vector input) and multiple dose sets (matrix input).
Incorporates pseudocount (Beta-Binomial prior).
}
\details{
PAVA enforces non-decreasing monotonicity constraint. Pseudocounts
(0.05 to DLT count, 0.1 to total patients) are added before estimation.
Patient counts weighted by inverse variance are used as weights in PAVA.
}
\examples{
# Single dose set
n_pts <- c(3, 6, 9, 12)
n_tox <- c(0, 1, 3, 4)
iso_est <- isotonic_regression(n_pts, n_tox, min_sample = 3)
print(iso_est)

# Multiple dose sets (matrix)
n_pts_matrix <- matrix(c(3, 6, 9, 12, 3, 6, 9, 12), nrow = 2, byrow = TRUE)
n_tox_matrix <- matrix(c(0, 1, 3, 4, 1, 2, 4, 5), nrow = 2, byrow = TRUE)
iso_est_matrix <- isotonic_regression(n_pts_matrix, n_tox_matrix, min_sample = 3)
print(iso_est_matrix)

}
\references{
Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I Clinical
Trials. Journal of the Royal Statistical Society: Series C, 64, 507-523.
}
