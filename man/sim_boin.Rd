% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_boin.R
\name{sim_boin}
\alias{sim_boin}
\title{Run BOIN Simulation with Operating Characteristics}
\usage{
sim_boin(n_trials = 10000, target, p_true, n_cohort, cohort_size,
           n_earlystop = 18, cutoff_eli = 0.95, extrasafe = FALSE,
           offset = 0.05, n_earlystop_rule = "with_stay", titration = FALSE,
           min_mtd_sample = 1, boundMTD = FALSE, seed = 123)
}
\arguments{
\item{n_trials}{Numeric. Number of trials to simulate. Default is 10000.}

\item{target}{Numeric. Target toxicity probability (e.g., 0.30 for 30\%).}

\item{p_true}{Numeric vector. True toxicity probabilities for each dose.
Length determines number of doses.}

\item{n_cohort}{Numeric. Maximum number of cohorts per trial.}

\item{cohort_size}{Numeric vector or scalar. Patients per cohort.}

\item{n_earlystop}{Numeric. Sample size triggering early stopping. Default is 18.}

\item{cutoff_eli}{Numeric. Cutoff for dose elimination. Default is 0.95.}

\item{extrasafe}{Logical. Apply extra safety stopping rule. Default is FALSE.}

\item{offset}{Numeric. Offset for safety cutoff when extrasafe = TRUE. Default is 0.05.}

\item{n_earlystop_rule}{Character. Early stopping rule: "with_stay" (BOIN standard) or "simple".
Default is "with_stay".}

\item{titration}{Logical. Perform accelerated dose titration phase. Default is FALSE.}

\item{min_mtd_sample}{Numeric. Minimum patients required for MTD consideration. Default is 1.}

\item{boundMTD}{Logical. Impose boundMTD constraint on MTD selection. Default is FALSE.}

\item{seed}{Numeric. Random seed for reproducibility. Default is 123.}
}
\value{
Object of class "boin_summary" (S3 object) containing:
\item{p_true}{Numeric vector. True toxicity probabilities}
\item{mtd_selection_percent}{Numeric vector. MTD selection rate (\%) per dose + No MTD}
\item{avg_n_pts}{Numeric vector. Average patients treated per dose}
\item{avg_n_tox}{Numeric vector. Average DLTs per dose}
\item{avg_total_n_pts}{Numeric. Average total patients}
\item{avg_total_n_tox}{Numeric. Average total DLTs}

Use \code{print(result)} to display operating characteristics in formatted table.
}
\description{
Execute multiple BOIN trial simulations and compute operating characteristics.
Combines patient enrollment, toxicity tracking, isotonic regression, and MTD
selection into a single streamlined function.
}
\details{
This function streamlines the entire BOIN simulation workflow:
\enumerate{
\item Call \code{get_pts_and_tox()} to generate trial data
\item Call \code{isotonic_regression()} to estimate dose-toxicity relationship
\item Call \code{select_mtd()} to select MTD for each trial
\item Aggregate results into operating characteristics
\item Return S3 object with custom print method
}
}
\examples{
# Basic BOIN simulation
result <- sim_boin(
  n_trials = 1000,
  target = 0.30,
  p_true = c(0.10, 0.25, 0.40, 0.55, 0.70),
  n_cohort = 10,
  cohort_size = 3,
  seed = 123
)
print(result)

# With BOIN standard (boundMTD + with_stay)
result_standard <- sim_boin(
  n_trials = 1000,
  target = 0.30,
  p_true = c(0.10, 0.25, 0.40, 0.55, 0.70),
  n_cohort = 10,
  cohort_size = 3,
  boundMTD = TRUE,
  n_earlystop_rule = "with_stay",
  seed = 123
)
print(result_standard)

# With titration phase
result_tit <- sim_boin(
  n_trials = 1000,
  target = 0.30,
  p_true = c(0.10, 0.25, 0.40, 0.55, 0.70),
  n_cohort = 10,
  cohort_size = 3,
  titration = TRUE,
  seed = 123
)
print(result_tit)

}
\references{
Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I Clinical
Trials. Journal of the Royal Statistical Society: Series C, 64, 507-523.
}
\seealso{
\code{\link{get_pts_and_tox}} for data generation
\code{\link{isotonic_regression}} for dose-toxicity estimation
\code{\link{select_mtd}} for MTD selection
}
